// 此文件由 scripts/build-worker.ts 自动生成，请勿手动编辑
// 运行 pnpm build:worker 重新生成

export const BOUNDARY_WORKER_CODE = "\nself.onerror = function(message, source, lineno, colno, error) {\n  self.postMessage({ id: -1, error: 'Worker global error: ' + message });\n  return true;\n};\n\ntry {\n\"use strict\";(()=>{function G(t){\"@babel/helpers - typeof\";return G=typeof Symbol==\"function\"&&typeof Symbol.iterator==\"symbol\"?function(e){return typeof e}:function(e){return e&&typeof Symbol==\"function\"&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},G(t)}var J=/^\\s+/,K=/\\s+$/;function u(t,e){if(t=t||\"\",e=e||{},t instanceof u)return t;if(!(this instanceof u))return new u(t,e);var r=Q(t);this._originalInput=t,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||r.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=r.ok}u.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),r,n,s,a,i,o;return r=e.r/255,n=e.g/255,s=e.b/255,r<=.03928?a=r/12.92:a=Math.pow((r+.055)/1.055,2.4),n<=.03928?i=n/12.92:i=Math.pow((n+.055)/1.055,2.4),s<=.03928?o=s/12.92:o=Math.pow((s+.055)/1.055,2.4),.2126*a+.7152*i+.0722*o},setAlpha:function(e){return this._a=V(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=N(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=N(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),s=Math.round(e.v*100);return this._a==1?\"hsv(\"+r+\", \"+n+\"%, \"+s+\"%)\":\"hsva(\"+r+\", \"+n+\"%, \"+s+\"%, \"+this._roundA+\")\"},toHsl:function(){var e=E(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=E(this._r,this._g,this._b),r=Math.round(e.h*360),n=Math.round(e.s*100),s=Math.round(e.l*100);return this._a==1?\"hsl(\"+r+\", \"+n+\"%, \"+s+\"%)\":\"hsla(\"+r+\", \"+n+\"%, \"+s+\"%, \"+this._roundA+\")\"},toHex:function(e){return q(this._r,this._g,this._b,e)},toHexString:function(e){return\"#\"+this.toHex(e)},toHex8:function(e){return nt(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return\"#\"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?\"rgb(\"+Math.round(this._r)+\", \"+Math.round(this._g)+\", \"+Math.round(this._b)+\")\":\"rgba(\"+Math.round(this._r)+\", \"+Math.round(this._g)+\", \"+Math.round(this._b)+\", \"+this._roundA+\")\"},toPercentageRgb:function(){return{r:Math.round(M(this._r,255)*100)+\"%\",g:Math.round(M(this._g,255)*100)+\"%\",b:Math.round(M(this._b,255)*100)+\"%\",a:this._a}},toPercentageRgbString:function(){return this._a==1?\"rgb(\"+Math.round(M(this._r,255)*100)+\"%, \"+Math.round(M(this._g,255)*100)+\"%, \"+Math.round(M(this._b,255)*100)+\"%)\":\"rgba(\"+Math.round(M(this._r,255)*100)+\"%, \"+Math.round(M(this._g,255)*100)+\"%, \"+Math.round(M(this._b,255)*100)+\"%, \"+this._roundA+\")\"},toName:function(){return this._a===0?\"transparent\":this._a<1?!1:dt[q(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var r=\"#\"+O(this._r,this._g,this._b,this._a),n=r,s=this._gradientType?\"GradientType = 1, \":\"\";if(e){var a=u(e);n=\"#\"+O(a._r,a._g,a._b,a._a)}return\"progid:DXImageTransform.Microsoft.gradient(\"+s+\"startColorstr=\"+r+\",endColorstr=\"+n+\")\"},toString:function(e){var r=!!e;e=e||this._format;var n=!1,s=this._a<1&&this._a>=0,a=!r&&s&&(e===\"hex\"||e===\"hex6\"||e===\"hex3\"||e===\"hex4\"||e===\"hex8\"||e===\"name\");return a?e===\"name\"&&this._a===0?this.toName():this.toRgbString():(e===\"rgb\"&&(n=this.toRgbString()),e===\"prgb\"&&(n=this.toPercentageRgbString()),(e===\"hex\"||e===\"hex6\")&&(n=this.toHexString()),e===\"hex3\"&&(n=this.toHexString(!0)),e===\"hex4\"&&(n=this.toHex8String(!0)),e===\"hex8\"&&(n=this.toHex8String()),e===\"name\"&&(n=this.toName()),e===\"hsl\"&&(n=this.toHslString()),e===\"hsv\"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return u(this.toString())},_applyModification:function(e,r){var n=e.apply(null,[this].concat([].slice.call(r)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(ot,arguments)},brighten:function(){return this._applyModification(ut,arguments)},darken:function(){return this._applyModification(ft,arguments)},desaturate:function(){return this._applyModification(at,arguments)},saturate:function(){return this._applyModification(st,arguments)},greyscale:function(){return this._applyModification(it,arguments)},spin:function(){return this._applyModification(lt,arguments)},_applyCombination:function(e,r){return e.apply(null,[this].concat([].slice.call(r)))},analogous:function(){return this._applyCombination(gt,arguments)},complement:function(){return this._applyCombination(ht,arguments)},monochromatic:function(){return this._applyCombination(bt,arguments)},splitcomplement:function(){return this._applyCombination(ct,arguments)},triad:function(){return this._applyCombination(D,[3])},tetrad:function(){return this._applyCombination(D,[4])}};u.fromRatio=function(t,e){if(G(t)==\"object\"){var r={};for(var n in t)t.hasOwnProperty(n)&&(n===\"a\"?r[n]=t[n]:r[n]=F(t[n]));t=r}return u(t,e)};function Q(t){var e={r:0,g:0,b:0},r=1,n=null,s=null,a=null,i=!1,o=!1;return typeof t==\"string\"&&(t=yt(t)),G(t)==\"object\"&&(T(t.r)&&T(t.g)&&T(t.b)?(e=tt(t.r,t.g,t.b),i=!0,o=String(t.r).substr(-1)===\"%\"?\"prgb\":\"rgb\"):T(t.h)&&T(t.s)&&T(t.v)?(n=F(t.s),s=F(t.v),e=rt(t.h,n,s),i=!0,o=\"hsv\"):T(t.h)&&T(t.s)&&T(t.l)&&(n=F(t.s),a=F(t.l),e=et(t.h,n,a),i=!0,o=\"hsl\"),t.hasOwnProperty(\"a\")&&(r=t.a)),r=V(r),{ok:i,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:r}}function tt(t,e,r){return{r:M(t,255)*255,g:M(e,255)*255,b:M(r,255)*255}}function E(t,e,r){t=M(t,255),e=M(e,255),r=M(r,255);var n=Math.max(t,e,r),s=Math.min(t,e,r),a,i,o=(n+s)/2;if(n==s)a=i=0;else{var l=n-s;switch(i=o>.5?l/(2-n-s):l/(n+s),n){case t:a=(e-r)/l+(e<r?6:0);break;case e:a=(r-t)/l+2;break;case r:a=(t-e)/l+4;break}a/=6}return{h:a,s:i,l:o}}function et(t,e,r){var n,s,a;t=M(t,360),e=M(e,100),r=M(r,100);function i(h,C,x){return x<0&&(x+=1),x>1&&(x-=1),x<1/6?h+(C-h)*6*x:x<1/2?C:x<2/3?h+(C-h)*(2/3-x)*6:h}if(e===0)n=s=a=r;else{var o=r<.5?r*(1+e):r+e-r*e,l=2*r-o;n=i(l,o,t+1/3),s=i(l,o,t),a=i(l,o,t-1/3)}return{r:n*255,g:s*255,b:a*255}}function N(t,e,r){t=M(t,255),e=M(e,255),r=M(r,255);var n=Math.max(t,e,r),s=Math.min(t,e,r),a,i,o=n,l=n-s;if(i=n===0?0:l/n,n==s)a=0;else{switch(n){case t:a=(e-r)/l+(e<r?6:0);break;case e:a=(r-t)/l+2;break;case r:a=(t-e)/l+4;break}a/=6}return{h:a,s:i,v:o}}function rt(t,e,r){t=M(t,360)*6,e=M(e,100),r=M(r,100);var n=Math.floor(t),s=t-n,a=r*(1-e),i=r*(1-s*e),o=r*(1-(1-s)*e),l=n%6,h=[r,i,a,a,o,r][l],C=[o,r,r,i,a,a][l],x=[a,a,o,r,r,i][l];return{r:h*255,g:C*255,b:x*255}}function q(t,e,r,n){var s=[B(Math.round(t).toString(16)),B(Math.round(e).toString(16)),B(Math.round(r).toString(16))];return n&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join(\"\")}function nt(t,e,r,n,s){var a=[B(Math.round(t).toString(16)),B(Math.round(e).toString(16)),B(Math.round(r).toString(16)),B(U(n))];return s&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join(\"\")}function O(t,e,r,n){var s=[B(U(n)),B(Math.round(t).toString(16)),B(Math.round(e).toString(16)),B(Math.round(r).toString(16))];return s.join(\"\")}u.equals=function(t,e){return!t||!e?!1:u(t).toRgbString()==u(e).toRgbString()};u.random=function(){return u.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function at(t,e){e=e===0?0:e||10;var r=u(t).toHsl();return r.s-=e/100,r.s=Y(r.s),u(r)}function st(t,e){e=e===0?0:e||10;var r=u(t).toHsl();return r.s+=e/100,r.s=Y(r.s),u(r)}function it(t){return u(t).desaturate(100)}function ot(t,e){e=e===0?0:e||10;var r=u(t).toHsl();return r.l+=e/100,r.l=Y(r.l),u(r)}function ut(t,e){e=e===0?0:e||10;var r=u(t).toRgb();return r.r=Math.max(0,Math.min(255,r.r-Math.round(255*-(e/100)))),r.g=Math.max(0,Math.min(255,r.g-Math.round(255*-(e/100)))),r.b=Math.max(0,Math.min(255,r.b-Math.round(255*-(e/100)))),u(r)}function ft(t,e){e=e===0?0:e||10;var r=u(t).toHsl();return r.l-=e/100,r.l=Y(r.l),u(r)}function lt(t,e){var r=u(t).toHsl(),n=(r.h+e)%360;return r.h=n<0?360+n:n,u(r)}function ht(t){var e=u(t).toHsl();return e.h=(e.h+180)%360,u(e)}function D(t,e){if(isNaN(e)||e<=0)throw new Error(\"Argument to polyad must be a positive number\");for(var r=u(t).toHsl(),n=[u(t)],s=360/e,a=1;a<e;a++)n.push(u({h:(r.h+a*s)%360,s:r.s,l:r.l}));return n}function ct(t){var e=u(t).toHsl(),r=e.h;return[u(t),u({h:(r+72)%360,s:e.s,l:e.l}),u({h:(r+216)%360,s:e.s,l:e.l})]}function gt(t,e,r){e=e||6,r=r||30;var n=u(t).toHsl(),s=360/r,a=[u(t)];for(n.h=(n.h-(s*e>>1)+720)%360;--e;)n.h=(n.h+s)%360,a.push(u(n));return a}function bt(t,e){e=e||6;for(var r=u(t).toHsv(),n=r.h,s=r.s,a=r.v,i=[],o=1/e;e--;)i.push(u({h:n,s,v:a})),a=(a+o)%1;return i}u.mix=function(t,e,r){r=r===0?0:r||50;var n=u(t).toRgb(),s=u(e).toRgb(),a=r/100,i={r:(s.r-n.r)*a+n.r,g:(s.g-n.g)*a+n.g,b:(s.b-n.b)*a+n.b,a:(s.a-n.a)*a+n.a};return u(i)};u.readability=function(t,e){var r=u(t),n=u(e);return(Math.max(r.getLuminance(),n.getLuminance())+.05)/(Math.min(r.getLuminance(),n.getLuminance())+.05)};u.isReadable=function(t,e,r){var n=u.readability(t,e),s,a;switch(a=!1,s=Mt(r),s.level+s.size){case\"AAsmall\":case\"AAAlarge\":a=n>=4.5;break;case\"AAlarge\":a=n>=3;break;case\"AAAsmall\":a=n>=7;break}return a};u.mostReadable=function(t,e,r){var n=null,s=0,a,i,o,l;r=r||{},i=r.includeFallbackColors,o=r.level,l=r.size;for(var h=0;h<e.length;h++)a=u.readability(t,e[h]),a>s&&(s=a,n=u(e[h]));return u.isReadable(t,n,{level:o,size:l})||!i?n:(r.includeFallbackColors=!1,u.mostReadable(t,[\"#fff\",\"#000\"],r))};var L=u.names={aliceblue:\"f0f8ff\",antiquewhite:\"faebd7\",aqua:\"0ff\",aquamarine:\"7fffd4\",azure:\"f0ffff\",beige:\"f5f5dc\",bisque:\"ffe4c4\",black:\"000\",blanchedalmond:\"ffebcd\",blue:\"00f\",blueviolet:\"8a2be2\",brown:\"a52a2a\",burlywood:\"deb887\",burntsienna:\"ea7e5d\",cadetblue:\"5f9ea0\",chartreuse:\"7fff00\",chocolate:\"d2691e\",coral:\"ff7f50\",cornflowerblue:\"6495ed\",cornsilk:\"fff8dc\",crimson:\"dc143c\",cyan:\"0ff\",darkblue:\"00008b\",darkcyan:\"008b8b\",darkgoldenrod:\"b8860b\",darkgray:\"a9a9a9\",darkgreen:\"006400\",darkgrey:\"a9a9a9\",darkkhaki:\"bdb76b\",darkmagenta:\"8b008b\",darkolivegreen:\"556b2f\",darkorange:\"ff8c00\",darkorchid:\"9932cc\",darkred:\"8b0000\",darksalmon:\"e9967a\",darkseagreen:\"8fbc8f\",darkslateblue:\"483d8b\",darkslategray:\"2f4f4f\",darkslategrey:\"2f4f4f\",darkturquoise:\"00ced1\",darkviolet:\"9400d3\",deeppink:\"ff1493\",deepskyblue:\"00bfff\",dimgray:\"696969\",dimgrey:\"696969\",dodgerblue:\"1e90ff\",firebrick:\"b22222\",floralwhite:\"fffaf0\",forestgreen:\"228b22\",fuchsia:\"f0f\",gainsboro:\"dcdcdc\",ghostwhite:\"f8f8ff\",gold:\"ffd700\",goldenrod:\"daa520\",gray:\"808080\",green:\"008000\",greenyellow:\"adff2f\",grey:\"808080\",honeydew:\"f0fff0\",hotpink:\"ff69b4\",indianred:\"cd5c5c\",indigo:\"4b0082\",ivory:\"fffff0\",khaki:\"f0e68c\",lavender:\"e6e6fa\",lavenderblush:\"fff0f5\",lawngreen:\"7cfc00\",lemonchiffon:\"fffacd\",lightblue:\"add8e6\",lightcoral:\"f08080\",lightcyan:\"e0ffff\",lightgoldenrodyellow:\"fafad2\",lightgray:\"d3d3d3\",lightgreen:\"90ee90\",lightgrey:\"d3d3d3\",lightpink:\"ffb6c1\",lightsalmon:\"ffa07a\",lightseagreen:\"20b2aa\",lightskyblue:\"87cefa\",lightslategray:\"789\",lightslategrey:\"789\",lightsteelblue:\"b0c4de\",lightyellow:\"ffffe0\",lime:\"0f0\",limegreen:\"32cd32\",linen:\"faf0e6\",magenta:\"f0f\",maroon:\"800000\",mediumaquamarine:\"66cdaa\",mediumblue:\"0000cd\",mediumorchid:\"ba55d3\",mediumpurple:\"9370db\",mediumseagreen:\"3cb371\",mediumslateblue:\"7b68ee\",mediumspringgreen:\"00fa9a\",mediumturquoise:\"48d1cc\",mediumvioletred:\"c71585\",midnightblue:\"191970\",mintcream:\"f5fffa\",mistyrose:\"ffe4e1\",moccasin:\"ffe4b5\",navajowhite:\"ffdead\",navy:\"000080\",oldlace:\"fdf5e6\",olive:\"808000\",olivedrab:\"6b8e23\",orange:\"ffa500\",orangered:\"ff4500\",orchid:\"da70d6\",palegoldenrod:\"eee8aa\",palegreen:\"98fb98\",paleturquoise:\"afeeee\",palevioletred:\"db7093\",papayawhip:\"ffefd5\",peachpuff:\"ffdab9\",peru:\"cd853f\",pink:\"ffc0cb\",plum:\"dda0dd\",powderblue:\"b0e0e6\",purple:\"800080\",rebeccapurple:\"663399\",red:\"f00\",rosybrown:\"bc8f8f\",royalblue:\"4169e1\",saddlebrown:\"8b4513\",salmon:\"fa8072\",sandybrown:\"f4a460\",seagreen:\"2e8b57\",seashell:\"fff5ee\",sienna:\"a0522d\",silver:\"c0c0c0\",skyblue:\"87ceeb\",slateblue:\"6a5acd\",slategray:\"708090\",slategrey:\"708090\",snow:\"fffafa\",springgreen:\"00ff7f\",steelblue:\"4682b4\",tan:\"d2b48c\",teal:\"008080\",thistle:\"d8bfd8\",tomato:\"ff6347\",turquoise:\"40e0d0\",violet:\"ee82ee\",wheat:\"f5deb3\",white:\"fff\",whitesmoke:\"f5f5f5\",yellow:\"ff0\",yellowgreen:\"9acd32\"},dt=u.hexNames=mt(L);function mt(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[t[r]]=r);return e}function V(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function M(t,e){pt(t)&&(t=\"100%\");var r=vt(t);return t=Math.min(e,Math.max(0,parseFloat(t))),r&&(t=parseInt(t*e,10)/100),Math.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function Y(t){return Math.min(1,Math.max(0,t))}function A(t){return parseInt(t,16)}function pt(t){return typeof t==\"string\"&&t.indexOf(\".\")!=-1&&parseFloat(t)===1}function vt(t){return typeof t==\"string\"&&t.indexOf(\"%\")!=-1}function B(t){return t.length==1?\"0\"+t:\"\"+t}function F(t){return t<=1&&(t=t*100+\"%\"),t}function U(t){return Math.round(parseFloat(t)*255).toString(16)}function j(t){return A(t)/255}var k=function(){var t=\"[-\\\\+]?\\\\d+%?\",e=\"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\",r=\"(?:\"+e+\")|(?:\"+t+\")\",n=\"[\\\\s|\\\\(]+(\"+r+\")[,|\\\\s]+(\"+r+\")[,|\\\\s]+(\"+r+\")\\\\s*\\\\)?\",s=\"[\\\\s|\\\\(]+(\"+r+\")[,|\\\\s]+(\"+r+\")[,|\\\\s]+(\"+r+\")[,|\\\\s]+(\"+r+\")\\\\s*\\\\)?\";return{CSS_UNIT:new RegExp(r),rgb:new RegExp(\"rgb\"+n),rgba:new RegExp(\"rgba\"+s),hsl:new RegExp(\"hsl\"+n),hsla:new RegExp(\"hsla\"+s),hsv:new RegExp(\"hsv\"+n),hsva:new RegExp(\"hsva\"+s),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function T(t){return!!k.CSS_UNIT.exec(t)}function yt(t){t=t.replace(J,\"\").replace(K,\"\").toLowerCase();var e=!1;if(L[t])t=L[t],e=!0;else if(t==\"transparent\")return{r:0,g:0,b:0,a:0,format:\"name\"};var r;return(r=k.rgb.exec(t))?{r:r[1],g:r[2],b:r[3]}:(r=k.rgba.exec(t))?{r:r[1],g:r[2],b:r[3],a:r[4]}:(r=k.hsl.exec(t))?{h:r[1],s:r[2],l:r[3]}:(r=k.hsla.exec(t))?{h:r[1],s:r[2],l:r[3],a:r[4]}:(r=k.hsv.exec(t))?{h:r[1],s:r[2],v:r[3]}:(r=k.hsva.exec(t))?{h:r[1],s:r[2],v:r[3],a:r[4]}:(r=k.hex8.exec(t))?{r:A(r[1]),g:A(r[2]),b:A(r[3]),a:j(r[4]),format:e?\"name\":\"hex8\"}:(r=k.hex6.exec(t))?{r:A(r[1]),g:A(r[2]),b:A(r[3]),format:e?\"name\":\"hex\"}:(r=k.hex4.exec(t))?{r:A(r[1]+\"\"+r[1]),g:A(r[2]+\"\"+r[2]),b:A(r[3]+\"\"+r[3]),a:j(r[4]+\"\"+r[4]),format:e?\"name\":\"hex8\"}:(r=k.hex3.exec(t))?{r:A(r[1]+\"\"+r[1]),g:A(r[2]+\"\"+r[2]),b:A(r[3]+\"\"+r[3]),format:e?\"name\":\"hex\"}:!1}function Mt(t){var e,r;return t=t||{level:\"AA\",size:\"small\"},e=(t.level||\"AA\").toUpperCase(),r=(t.size||\"small\").toLowerCase(),e!==\"AA\"&&e!==\"AAA\"&&(e=\"AA\"),r!==\"small\"&&r!==\"large\"&&(r=\"small\"),{level:e,size:r}}function W(t=\"AA\",e=\"auto\",r=\"graphics\"){if(t===\"AAA\")switch(e){case\"large-text\":return 4.5;case\"normal-text\":return 7;case\"graphics\":return 3;case\"auto\":return r===\"text\"?7:3;default:return r===\"text\"?7:3}else switch(e){case\"large-text\":return 3;case\"normal-text\":return 4.5;case\"graphics\":return 3;case\"auto\":return r===\"text\"?4.5:3;default:return r===\"text\"?4.5:3}}var X=(t,e,r=1)=>{let n=u(t),s=u(e);s.setAlpha(r);let a=s;return r<1&&(a=u.mix(n.toRgbString(),s.toRgbString(),r*100)),u.readability(n,a)};var _t=(t,e,r)=>{if(t=Math.round(t)%360,t<0&&(t+=360),e===0){let h=Math.round(r*255);return{r:h,g:h,b:h}}let n=(1-Math.abs(2*r-1))*e,s=n*(1-Math.abs(t/60%2-1)),a=r-n/2,i=0,o=0,l=0;return t<60?(i=n,o=s,l=0):t<120?(i=s,o=n,l=0):t<180?(i=0,o=n,l=s):t<240?(i=0,o=s,l=n):t<300?(i=s,o=0,l=n):(i=n,o=0,l=s),{r:Math.round((i+a)*255),g:Math.round((o+a)*255),b:Math.round((l+a)*255)}},xt=(t,e,r)=>{if(t=Math.round(t)%360,t<0&&(t+=360),e===0){let h=Math.round(r*255);return{r:h,g:h,b:h}}let n=r*e,s=n*(1-Math.abs(t/60%2-1)),a=r-n,i=0,o=0,l=0;return t<60?(i=n,o=s,l=0):t<120?(i=s,o=n,l=0):t<180?(i=0,o=n,l=s):t<240?(i=0,o=s,l=n):t<300?(i=s,o=0,l=n):(i=n,o=0,l=s),{r:Math.round((i+a)*255),g:Math.round((o+a)*255),b:Math.round((l+a)*255)}},Z=(t,e)=>Math.atan2(e[1]-t[1],e[0]-t[0]),St=(t,e)=>{let r=e-t;for(;r<=-Math.PI;)r+=2*Math.PI;for(;r>Math.PI;)r-=2*Math.PI;return Math.abs(r)},Ct=(t,e,r)=>{let[n,s]=t,[a,i]=e,[o,l]=r,h=Math.pow(o-a,2)+Math.pow(l-i,2);if(h===0)return Math.sqrt(Math.pow(n-a,2)+Math.pow(s-i,2));let C=Math.max(0,Math.min(1,((n-a)*(o-a)+(s-i)*(l-i))/h)),x=a+C*(o-a),S=i+C*(l-i);return Math.sqrt(Math.pow(n-x,2)+Math.pow(s-S,2))},$=(t,e)=>{if(t.length<=2)return t;let r=0,n=0,s=t[0],a=t[t.length-1];for(let i=1;i<t.length-1;i++){let o=Ct(t[i],s,a);o>r&&(r=o,n=i)}if(r>e){let i=$(t.slice(0,n+1),e),o=$(t.slice(n),e);return[...i.slice(0,-1),...o]}else return[s,a]},Rt=t=>{if(t.length===0)return 1;let e=t[0][0],r=t[0][0],n=t[0][1],s=t[0][1];for(let a=1;a<t.length;a++)e=Math.min(e,t[a][0]),r=Math.max(r,t[a][0]),n=Math.min(n,t[a][1]),s=Math.max(s,t[a][1]);return Math.max(r-e,s-n)||1},At=(t,e,r,n=Math.PI/2)=>{if(t.length<2)return[];try{r=Math.round(r),e=Math.round(e);let a=Rt(t)*.02,i=$(t,a),o=5,l=1;if(i.length>0){let d=i[0];if(d[0]<=l&&(d[0]=0),d[1]<=o?d[1]=0:d[1]>=e-o&&(d[1]=e),i.length>1){let m=i.length-1,b=i[m];b[1]<=o?b[1]=0:b[1]>=e-o&&(b[1]=e)}i=i.filter((m,b,R)=>b===0||m[0]!==R[b-1][0]||m[1]!==R[b-1][1])}if(i.length<2)return[];let h=new Array(i.length).fill(!1);if(i.length>=3){let d=Z(i[0],i[1]);for(let m=1;m<i.length-1;m++){let b=Z(i[m],i[m+1]);St(d,b)>n&&(h[m]=!0),d=b}}let C=new Array(i.length);if(i.length>=2){let d=i[1][0]-i[0][0],m=i[1][1]-i[0][1],b=Math.sqrt(d*d+m*m);C[0]=b?[d/b,m/b]:[0,0];let R=i.length-1,w=i[R][0]-i[R-1][0],H=i[R][1]-i[R-1][1],I=Math.sqrt(w*w+H*H);C[R]=I?[w/I,H/I]:[0,0];for(let f=1;f<R;f++){if(h[f])continue;let _=i[f-1],v=i[f+1],c=v[0]-_[0],y=v[1]-_[1],g=Math.sqrt(c*c+y*y);C[f]=g?[c/g,y/g]:[0,0]}}else return[];let x=[],S=.75;for(let d=0;d<i.length-1;d++){let m=i[d],b=i[d+1],R=h[d]||m[1]<=o||m[1]>=e-o||m[0]<=l||m[0]>=r-l,w=h[d+1]||b[1]<=o||b[1]>=e-o||b[0]<=l||b[0]>=r-l,H=[...m],I=[...b];if(!R){let f=C[d],_=Math.sqrt(Math.pow(b[0]-m[0],2)+Math.pow(b[1]-m[1],2));H=[m[0]+f[0]*_*S*.5,m[1]+f[1]*_*S*.5]}if(!w){let f=C[d+1],_=Math.sqrt(Math.pow(b[0]-m[0],2)+Math.pow(b[1]-m[1],2));I=[b[0]-f[0]*_*S*.5,b[1]-f[1]*_*S*.5]}x.push({start:m,cp1:H,cp2:I,end:b})}return x}catch{let s=[];if(t.length>=2)for(let a=0;a<t.length-1;a++)s.push({start:t[a],cp1:t[a],cp2:t[a+1],end:t[a+1]});return s}},kt=(t,e,r,n,s,a,i,o,l)=>{t=Math.round(t),e=Math.round(e),r=Math.round(r),s=Number(s.toFixed(2));let h=W(a,i,o),C={lowerBoundary:null,upperBoundary:null,threshold:h};if(t<=0||e<=0)return C;let x=l===\"hsl\",S=[],d=[],m=2,b=!0;for(let f=0;f<=t;f+=m){let _=[],v=null;for(let c=0;c<=e;c++){let y=f/t,g=1-c/e,p=x?_t(r,y,g):xt(r,y,g);(y>0||g>0)&&(b=!1);let z=X(n,p,s)>=h;z&&!v?v={startY:c,endY:c}:z&&v?v.endY=c:!z&&v&&(_.push({...v}),v=null)}if(v&&_.push({...v}),_.length===1){let c=_[0];c.startY===0?S.push([f,c.endY]):c.endY===e?d.push([f,c.startY]):(d.push([f,c.startY]),S.push([f,c.endY]))}else if(_.length>=2){let c=_[0],y=_[_.length-1];c.startY===0?S.push([f,c.endY]):(d.push([f,c.startY]),S.push([f,c.endY])),y.endY===e?(c.startY!==0||y.startY!==c.startY)&&d.push([f,y.startY]):y!==c&&(y.startY!==c.startY&&d.push([f,y.startY]),y.endY!==c.endY&&S.push([f,y.endY]))}}let R=(f,_)=>{if(f.length<2){if(b&&_){let g=[[0,e],[t,e]],p=[{start:g[0],cp1:g[0],cp2:g[1],end:g[1]}];return{points:g,simplifiedPoints:g,bezierSegments:p}}return null}f[0][0]>0?f.unshift([0,f[0][1]]):f[0][0]=0,f[f.length-1][0]<t?f.push([t,f[f.length-1][1]]):f[f.length-1][0]=t;let v=f.filter((g,p,P)=>p===0||g[0]!==P[p-1][0]||g[1]!==P[p-1][1]);if(v.length<2)return null;let c=At(v,e,t),y=2;if(c&&c.length>0){let g=c[0];g.start[1]<=1?(g.start=[g.start[0],-y],g.cp1=[g.cp1[0],Math.min(g.cp1[1],-y)]):g.start[1]>=e-1&&(g.start=[g.start[0],e+y],g.cp1=[g.cp1[0],Math.max(g.cp1[1],e+y)]);let p=c[c.length-1];p.end[1]<=1?(p.end=[p.end[0],-y],p.cp2=[p.cp2[0],Math.min(p.cp2[1],-y)]):p.end[1]>=e-1&&(p.end=[p.end[0],e+y],p.cp2=[p.cp2[0],Math.max(p.cp2[1],e+y)])}if(!c||c.length===0){if(v.length>=2){let g=[];for(let p=0;p<v.length-1;p++)g.push({start:v[p],cp1:v[p],cp2:v[p+1],end:v[p+1]});return{points:f,simplifiedPoints:v,bezierSegments:g}}return null}return{points:f,simplifiedPoints:v,bezierSegments:c}},w=R(S,!0),H=R(d,!1);if(s<.01&&!w&&!H){let f=[[0,e],[t,e]];return{lowerBoundary:{points:f,simplifiedPoints:f,bezierSegments:[{start:f[0],cp1:f[0],cp2:f[1],end:f[1]}]},upperBoundary:null,threshold:h}}if(!w&&!H){let f=[[0,e],[t,e]];return{lowerBoundary:{points:f,simplifiedPoints:f,bezierSegments:[{start:f[0],cp1:f[0],cp2:f[1],end:f[1]}]},upperBoundary:null,threshold:h}}return{lowerBoundary:w,upperBoundary:H,threshold:h}};self.onmessage=t=>{let{id:e,params:r}=t.data;if(!r){self.postMessage({id:e,error:\"Received message with undefined params\"});return}let{width:n,height:s,hue:a,backgroundColor:i,foregroundAlpha:o,level:l,category:h,selectedElementType:C,colorSpace:x}=r;try{let S=kt(n,s,a,i,o,l,h,C,x);self.postMessage({id:e,result:S})}catch(S){self.postMessage({id:e,error:S instanceof Error?S.message:String(S)})}};})();\n\n} catch (e) {\n  self.postMessage({ id: -1, error: 'Worker init error: ' + (e.message || e) });\n}\n\n// 发送初始化完成消息\nself.postMessage({ id: 0, status: 'ready' });\n";

// 创建 Worker 的函数
export const createBoundaryWorker = (): Worker | null => {
  if (typeof window === "undefined") {
    return null;
  }

  try {
    const blob = new Blob([BOUNDARY_WORKER_CODE], { type: "application/javascript" });
    const url = URL.createObjectURL(blob);
    const worker = new Worker(url);

    // 延迟清理 URL，确保 Worker 有足够时间加载
    setTimeout(() => {
      URL.revokeObjectURL(url);
    }, 1000);

    return worker;
  } catch {
    return null;
  }
};
