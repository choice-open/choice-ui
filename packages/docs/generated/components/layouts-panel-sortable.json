{
  "slug": "layouts/panel/sortable",
  "title": "Sortable",
  "package": {
    "name": "@choice-ui/panel",
    "version": "0.0.6",
    "description": "A panel component for organizing content in collapsible sections with headers and actions",
    "dependencies": {
      "usehooks-ts": "^3.1.0",
      "@choice-ui/shared": "workspace:*",
      "@choiceform/icons-react": "^1.3.8"
    },
    "peerDependencies": {
      "react": ">=18.0.0",
      "react-dom": ">=18.0.0"
    }
  },
  "exports": [
    "PanelBase",
    "Panel",
    "type PanelRowProps",
    "PanelRow",
    "PanelLabel",
    "PanelTitle",
    "PanelSortable",
    "PanelSortableRow",
    "PanelRowLabel",
    "type PanelRowManyIconItem",
    "type PanelRowManyIconProps",
    "PanelRowManyIcon",
    "PanelPreviewer",
    "type PanelContextType",
    "PanelContext",
    "usePanelContext",
    "type SortableItem",
    "type SortableRowDataContextValue",
    "SortableRowDataContext",
    "useSortableRowItem",
    "type SortablePaneContextValue",
    "SortablePaneContext",
    "useSortablePane"
  ],
  "props": [
    {
      "displayName": "Panel",
      "description": "",
      "props": [
        {
          "name": "className",
          "type": "string | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "alwaysShowCollapsible",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "collapsible",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "isCollapsed",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "isEmpty",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "onCollapsedChange",
          "type": "((isCollapsed: boolean) => void) | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "onEmptyChange",
          "type": "((isEmpty: boolean) => void) | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "showLabels",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "triggerRef",
          "type": "RefObject<HTMLDivElement> | undefined",
          "required": false,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelRow",
      "description": "",
      "props": [
        {
          "name": "type",
          "type": "undefined | \"single\" | \"two-columns\" | \"one-label-one-input\" | \"one-label-one-input-one-icon\" | \"one-label-two-input\" | \"one-icon-one-input\" | \"one-input-one-icon\" | \"one-input-two-icon\" | \"two-input-two-icon\" | \"two-input-one-icon\" | \"one-icon-one-input-one-icon\" | \"one-icon-one-input-two-icon\" | \"two-input-one-icon-double-row\"",
          "required": false,
          "defaultValue": "\"single\"",
          "description": "The type of the panel row.\n@description - `single`: `columns`: 1fr | `areas`: \"label\" \"input\" | `rows`: auto minmax(2rem, auto)\n- `two-columns`: `columns`: 1fr 1fr | `areas`: \"label-1 label-2\" \"input-1 input-2\" | `rows`: auto minmax(2rem, auto)\n- `one-label-one-input`: `columns`: 8fr 20fr | `areas`: \"label input\" | `rows`: 2rem\n- `one-label-one-input-one-icon`: `columns`: 8fr 20fr 1.5rem | `areas`: \"label input icon\" | `rows`: 2rem\n- `one-label-two-input`: `columns`: 8fr 10fr 10fr | `areas`: \"label input-1 input-2\" | `rows`: 2rem\n- `one-icon-one-input`: `columns`: 1.5rem 1fr | `areas`: \". label\" \"icon input\" | `rows`: auto minmax(2rem, auto)\n- `one-input-one-icon`: `columns`: 1fr 1.5rem | `areas`: \"label label\" \"input icon\" | `rows`: auto minmax(2rem, auto)\n- `one-input-two-icon`: `columns`: 1fr 0.5rem 1.5rem 0.25rem 1.5rem | `areas`: \"label . . . .\" \"input . icon-1 . icon-2\" | `rows`: auto minmax(2rem, auto)\n- `two-input-two-icon`: `columns`: minmax(76px, 1fr) 0.5rem 1fr 0.5rem 1.5rem 0.25rem 1.5rem | `areas`: \"label-1 label-1 label-2 label-2 . . .\" \"input-1 . input-2 . icon-1 . icon-2\" | `rows`: auto minmax(2rem, auto)\n- `two-input-one-icon`: `columns`: 1fr 1fr 1.5rem | `areas`: \"label-1 label-2 label-2\" \"input-1 input-2 icon\" | `rows`: auto minmax(2rem, auto)\n- `one-icon-one-input-one-icon`: `columns`: 1.5rem 0.5rem 1fr 0.5rem 1.5rem | `areas`: \"label label label label label\" \"icon-1 . input . icon-2\" | `rows`: auto minmax(2rem, auto)\n- `one-icon-one-input-two-icon`: `columns`: 1.5rem 0.5rem 1fr 0.5rem 1.5rem 0.25rem 1.5rem | `areas`: \"label label label label label label label\" \"icon-1 . input . icon-2 . icon-3\" | `rows`: auto minmax(2rem, auto)\n- `two-input-one-icon-double-row`: `columns`: 1fr 1fr 1.5rem | `areas`: \"label-1 label-2 .\" \"input-1 input-3 icon-1\" \"input-2 input-3 icon-2\" | `rows`: auto 2rem 2rem"
        },
        {
          "name": "active",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "triggerRef",
          "type": "RefObject<HTMLDivElement> | undefined",
          "required": false,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelLabel",
      "description": "",
      "props": [
        {
          "name": "className",
          "type": "string | undefined",
          "required": false,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelTitle",
      "description": "",
      "props": [
        {
          "name": "title",
          "type": "string",
          "required": true,
          "description": ""
        },
        {
          "name": "classNames",
          "type": "{ actionWrapper?: string | undefined; container?: string | undefined; title?: string | undefined; titleWrapper?: string | undefined; } | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "onHeaderClick",
          "type": "(() => void) | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "onTitleClick",
          "type": "(() => void) | undefined",
          "required": false,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelSortable",
      "description": "",
      "props": [
        {
          "name": "className",
          "type": "string | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "data",
          "type": "SortableItem[]",
          "required": true,
          "description": ""
        },
        {
          "name": "onDrop",
          "type": "(position: \"top\" | \"bottom\" | null, id: string, newIndex: number) => void",
          "required": true,
          "description": ""
        },
        {
          "name": "onSelectedIdChange",
          "type": "(id: string | null) => void",
          "required": true,
          "description": ""
        },
        {
          "name": "selectedId",
          "type": "string | null",
          "required": true,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelSortableRow",
      "description": "",
      "props": [
        {
          "name": "type",
          "type": "undefined | \"single\" | \"two-columns\" | \"one-label-one-input\" | \"one-label-one-input-one-icon\" | \"one-label-two-input\" | \"one-icon-one-input\" | \"one-input-one-icon\" | \"one-input-two-icon\" | \"two-input-two-icon\" | \"two-input-one-icon\" | \"one-icon-one-input-one-icon\" | \"one-icon-one-input-two-icon\" | \"two-input-one-icon-double-row\"",
          "required": false,
          "defaultValue": "\"single\"",
          "description": "The type of the panel row.\n@description - `single`: `columns`: 1fr | `areas`: \"label\" \"input\" | `rows`: auto minmax(2rem, auto)\n- `two-columns`: `columns`: 1fr 1fr | `areas`: \"label-1 label-2\" \"input-1 input-2\" | `rows`: auto minmax(2rem, auto)\n- `one-label-one-input`: `columns`: 8fr 20fr | `areas`: \"label input\" | `rows`: 2rem\n- `one-label-one-input-one-icon`: `columns`: 8fr 20fr 1.5rem | `areas`: \"label input icon\" | `rows`: 2rem\n- `one-label-two-input`: `columns`: 8fr 10fr 10fr | `areas`: \"label input-1 input-2\" | `rows`: 2rem\n- `one-icon-one-input`: `columns`: 1.5rem 1fr | `areas`: \". label\" \"icon input\" | `rows`: auto minmax(2rem, auto)\n- `one-input-one-icon`: `columns`: 1fr 1.5rem | `areas`: \"label label\" \"input icon\" | `rows`: auto minmax(2rem, auto)\n- `one-input-two-icon`: `columns`: 1fr 0.5rem 1.5rem 0.25rem 1.5rem | `areas`: \"label . . . .\" \"input . icon-1 . icon-2\" | `rows`: auto minmax(2rem, auto)\n- `two-input-two-icon`: `columns`: minmax(76px, 1fr) 0.5rem 1fr 0.5rem 1.5rem 0.25rem 1.5rem | `areas`: \"label-1 label-1 label-2 label-2 . . .\" \"input-1 . input-2 . icon-1 . icon-2\" | `rows`: auto minmax(2rem, auto)\n- `two-input-one-icon`: `columns`: 1fr 1fr 1.5rem | `areas`: \"label-1 label-2 label-2\" \"input-1 input-2 icon\" | `rows`: auto minmax(2rem, auto)\n- `one-icon-one-input-one-icon`: `columns`: 1.5rem 0.5rem 1fr 0.5rem 1.5rem | `areas`: \"label label label label label\" \"icon-1 . input . icon-2\" | `rows`: auto minmax(2rem, auto)\n- `one-icon-one-input-two-icon`: `columns`: 1.5rem 0.5rem 1fr 0.5rem 1.5rem 0.25rem 1.5rem | `areas`: \"label label label label label label label\" \"icon-1 . input . icon-2 . icon-3\" | `rows`: auto minmax(2rem, auto)\n- `two-input-one-icon-double-row`: `columns`: 1fr 1fr 1.5rem | `areas`: \"label-1 label-2 .\" \"input-1 input-3 icon-1\" \"input-2 input-3 icon-2\" | `rows`: auto 2rem 2rem"
        },
        {
          "name": "active",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "triggerRef",
          "type": "RefObject<HTMLDivElement> | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "ref",
          "type": "((instance: HTMLFieldSetElement | null) => void) | RefObject<HTMLFieldSetElement> | null | undefined",
          "required": false,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelRowLabel",
      "description": "",
      "props": [
        {
          "name": "label",
          "type": "string",
          "required": true,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelRowManyIcon",
      "description": "",
      "props": [
        {
          "name": "icons",
          "type": "PanelRowManyIconItem[]",
          "required": true,
          "description": ""
        },
        {
          "name": "isEditing",
          "type": "boolean | undefined",
          "required": false,
          "description": ""
        }
      ]
    },
    {
      "displayName": "PanelPreviewer",
      "description": "",
      "props": []
    }
  ],
  "stories": [
    {
      "id": "layouts-panel-sortable--basic",
      "name": "Basic",
      "exportName": "Basic",
      "description": "Basic sortable panel with a single item.\n\nWhen only one item exists, the drag handle is automatically hidden since reordering is not possible.\nAdd more items using the \"+\" button to enable drag-and-drop functionality.\n\n### Features demonstrated:\n- Single item mode (no drag handle)\n- Add/remove items\n- Toggle visibility\n- Popover integration\n- Select dropdown within sortable rows",
      "source": "import { Panel } from \"@choice-ui/panel\"\nimport { useState, useEffect, useCallback, useRef } from \"react\"\n\nexport default function App() {\n\n  const [items, setItems] = useState<SortableItem[]>(BASIC_INITIAL_DATA)\n  const [selectedId, setSelectedId] = useState<string | null>(null)\n  const open$ = useObservable<string | null>(null)\n  const triggerRefs = useRef<Map<string, HTMLFieldSetElement>>(new Map())\n\n  const handleAdd = useCallback(() => {\n    const newItem: SortableItem = {\n      id: nanoid(),\n      indexKey: String(Date.now()),\n      value: \"option-a\",\n      visible: true,\n    }\n    setItems((prev) => [...prev, newItem])\n  }, [])\n\n  const handleRemove = useCallback((id: string) => {\n    setItems((prev) => prev.filter((item) => item.id !== id))\n    setSelectedId(null)\n  }, [])\n\n  const handleVisible = useCallback((id: string) => {\n    setItems((prev) =>\n      prev.map((item) => (item.id === id ? { ...item, visible: !item.visible } : item)),\n    )\n  }, [])\n\n  const handleValueChange = useCallback((id: string, value: string) => {\n    setItems((prev) =>\n      prev.map((item) => (item.id === id ? { ...item, value } : item)),\n    )\n  }, [])\n\n  const handleDrop = useCallback(\n    (position: \"top\" | \"bottom\" | null, dragId: string, dropIndex: number) => {\n      setItems((prev) => {\n        const dragIndex = prev.findIndex((item) => item.id === dragId)\n        if (dragIndex === -1) return prev\n\n        const targetIndex = calculateTargetIndex(dragIndex, dropIndex, position)\n        return moveItem(prev, dragIndex, targetIndex)\n      })\n    },\n    [],\n  )\n\n  // Keyboard delete handler\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if ((e.key === \"Delete\" || e.key === \"Backspace\") && selectedId) {\n        handleRemove(selectedId)\n      }\n    }\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [selectedId, handleRemove])\n\n  return (\n    <>\n      <AllotmentContainer>\n        <Panel>\n          <Panel.Title title=\"Single Item (No Drag Handle)\">\n            <IconButton\n              onClick={handleAdd}\n              tooltip={{ content: \"Add item\" }}\n            >\n              <AddSmall />\n            </IconButton>\n          </Panel.Title>\n\n          <Panel.Sortable\n            data={items}\n            selectedId={selectedId}\n            onSelectedIdChange={setSelectedId}\n            onDrop={handleDrop}\n          >\n            <BasicRowContent\n              triggerRefs={triggerRefs}\n              open$={open$}\n              onRemove={handleRemove}\n              onVisible={handleVisible}\n              onValueChange={handleValueChange}\n            />\n          </Panel.Sortable>\n        </Panel>\n      </AllotmentContainer>\n\n      <SortablePopover\n        triggerRefs={triggerRefs}\n        open$={open$}\n      />\n    </>\n  )\n\n}"
    },
    {
      "id": "layouts-panel-sortable--multiple-items",
      "name": "Multiple Items",
      "exportName": "MultipleItems",
      "description": "Multiple items sortable panel demonstrating full drag-and-drop functionality.\n\n### Features demonstrated:\n- Drag handle visible for reordering\n- Drop indicator shows placement position (top/bottom)\n- Auto-scroll when dragging near container edges\n- Selection state with keyboard delete support\n- Interactive elements (Select, IconButtons) don't trigger drag\n\n### Interaction:\n- **Drag**: Click and hold the drag handle (grip icon) to reorder\n- **Select**: Click anywhere on the row to select it\n- **Delete**: Press Delete or Backspace when an item is selected\n- **Popover**: Click the effect icon to open a popover",
      "source": "import { Panel } from \"@choice-ui/panel\"\nimport { useState, useEffect, useCallback, useRef } from \"react\"\n\nexport default function App() {\n\n  const [items, setItems] = useState<SortableItem[]>(MULTIPLE_INITIAL_DATA)\n  const [selectedId, setSelectedId] = useState<string | null>(null)\n  const open$ = useObservable<string | null>(null)\n  const triggerRefs = useRef<Map<string, HTMLFieldSetElement>>(new Map())\n\n  const handleAdd = useCallback(() => {\n    const newItem: SortableItem = {\n      id: nanoid(),\n      indexKey: String(Date.now()),\n      value: faker.helpers.arrayElement(SELECT_OPTIONS).value,\n      visible: true,\n    }\n    setItems((prev) => [...prev, newItem])\n  }, [])\n\n  const handleRemove = useCallback((id: string) => {\n    setItems((prev) => prev.filter((item) => item.id !== id))\n    setSelectedId(null)\n  }, [])\n\n  const handleVisible = useCallback((id: string) => {\n    setItems((prev) =>\n      prev.map((item) => (item.id === id ? { ...item, visible: !item.visible } : item)),\n    )\n  }, [])\n\n  const handleValueChange = useCallback((id: string, value: string) => {\n    setItems((prev) =>\n      prev.map((item) => (item.id === id ? { ...item, value } : item)),\n    )\n  }, [])\n\n  const handleDrop = useCallback(\n    (position: \"top\" | \"bottom\" | null, dragId: string, dropIndex: number) => {\n      setItems((prev) => {\n        const dragIndex = prev.findIndex((item) => item.id === dragId)\n        if (dragIndex === -1) return prev\n\n        const targetIndex = calculateTargetIndex(dragIndex, dropIndex, position)\n        return moveItem(prev, dragIndex, targetIndex)\n      })\n    },\n    [],\n  )\n\n  // Keyboard delete handler\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if ((e.key === \"Delete\" || e.key === \"Backspace\") && selectedId) {\n        handleRemove(selectedId)\n      }\n    }\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [selectedId, handleRemove])\n\n  return (\n    <>\n      <AllotmentContainer>\n        <Panel>\n          <Panel.Title title=\"Sortable\">\n            <IconButton\n              onClick={handleAdd}\n              tooltip={{ content: \"Add item\" }}\n            >\n              <AddSmall />\n            </IconButton>\n          </Panel.Title>\n\n          <Panel.Sortable\n            data={items}\n            selectedId={selectedId}\n            onSelectedIdChange={setSelectedId}\n            onDrop={handleDrop}\n          >\n            <MultipleRowContent\n              triggerRefs={triggerRefs}\n              open$={open$}\n              onRemove={handleRemove}\n              onVisible={handleVisible}\n              onValueChange={handleValueChange}\n            />\n          </Panel.Sortable>\n        </Panel>\n      </AllotmentContainer>\n\n      <SortablePopover\n        triggerRefs={triggerRefs}\n        open$={open$}\n      />\n    </>\n  )\n\n}"
    }
  ]
}