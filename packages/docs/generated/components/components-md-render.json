{
  "slug": "components/md-render",
  "title": "MdRender",
  "package": {
    "name": "@choice-ui/md-render",
    "version": "0.0.3",
    "description": "Markdown Render component for Choiceform Design System",
    "dependencies": {
      "marked": "^15.0.7",
      "react-markdown": "^9.0.3",
      "remark-gfm": "^4.0.1",
      "remark-breaks": "^4.0.0",
      "remark-math": "^6.0.0",
      "harden-react-markdown": "^1.0.4",
      "@choice-ui/code-block": "workspace:*",
      "@choice-ui/shared": "workspace:*",
      "@choiceform/icons-react": "^1.3.8",
      "@choice-ui/scroll-area": "workspace:*"
    },
    "peerDependencies": {
      "react": ">=18.0.0",
      "react-dom": ">=18.0.0"
    }
  },
  "exports": [
    "MdRender",
    "type MdRenderProps",
    "type MentionRenderProps",
    "MD_BLOCK_DEFAULT_ALLOWED_IMAGE_PREFIXES",
    "MD_BLOCK_DEFAULT_ALLOWED_LINK_PREFIXES"
  ],
  "props": [
    {
      "displayName": "MdRenderProps",
      "description": "",
      "props": [
        {
          "name": "allowedPrefixes",
          "type": "string[] | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "className",
          "type": "string | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "components",
          "type": "Partial<Components> | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "content",
          "type": "string",
          "required": true,
          "description": ""
        },
        {
          "name": "customColor",
          "type": "{ codeBackground?: string | undefined; defaultBackground?: string | undefined; defaultBoundary?: string | undefined; defaultForeground?: string | undefined; secondaryBackground?: string | undefined; secondaryForeground?: string | undefined; } | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "id",
          "type": "string | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "mentionItems",
          "type": "MentionItemProps[] | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "mentionRenderComponent",
          "type": "ComponentType<MentionRenderProps> | undefined",
          "required": false,
          "description": ""
        },
        {
          "name": "size",
          "type": "undefined | \"small\" | \"default\" | \"large\"",
          "required": false,
          "description": ""
        },
        {
          "name": "variant",
          "type": "undefined | \"default\" | \"github\"",
          "required": false,
          "description": ""
        },
        {
          "name": "ref",
          "type": "((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null | undefined",
          "required": false,
          "description": ""
        }
      ]
    }
  ],
  "stories": [
    {
      "id": "components-mdrender--basic",
      "name": "Basic",
      "exportName": "Basic",
      "description": "Basic markdown rendering with common formatting elements.\n- Headings, paragraphs, lists\n- Bold, italic, strikethrough text\n- Links and inline code",
      "source": ""
    },
    {
      "id": "components-mdrender--git-hub-flavored-markdown",
      "name": "Git Hub Flavored Markdown",
      "exportName": "GitHubFlavoredMarkdown",
      "description": "Comprehensive GitHub Flavored Markdown demonstration.\n- All GFM features including tables, task lists, blockquotes\n- Code blocks with syntax highlighting\n- Complex nested structures",
      "source": ""
    },
    {
      "id": "components-mdrender--custom-color",
      "name": "Custom Color",
      "exportName": "CustomColor",
      "description": "GitHub Flavored Markdown with custom color.\n- Demonstrates custom color options for the markdown renderer.",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\n\nexport default function App() {\n\n  const isDarkMode = true\n  const customColor = {\n    defaultBackground: isDarkMode ? \"var(--color-pink-pale-700)\" : \"var(--color-pink-300)\",\n    defaultBoundary: isDarkMode ? \"var(--color-pink-pale-500)\" : \"var(--color-pink-400)\",\n    secondaryBackground: isDarkMode ? \"var(--color-pink-pale-600)\" : \"var(--color-pink-200)\",\n    secondaryForeground: isDarkMode ? \"var(--color-pink-pale-900)\" : \"var(--color-pink-pale-500)\",\n    codeBackground: isDarkMode ? \"var(--color-pink-pale-800)\" : \"var(--color-pink-100)\",\n  }\n  return (\n    <MdRender\n      className=\"p-4\"\n      content={GitHubFlavoredMarkdownContent}\n      customColor={customColor}\n    />\n  )\n\n}"
    },
    {
      "id": "components-mdrender--code-blocks",
      "name": "Code Blocks",
      "exportName": "CodeBlocks",
      "description": "Code blocks with multiple programming languages.\n- Syntax highlighting powered by Shiki\n- Copy-to-clipboard functionality\n- Support for JavaScript, TypeScript, Python, JSON, and more",
      "source": ""
    },
    {
      "id": "components-mdrender--task-lists",
      "name": "Task Lists",
      "exportName": "TaskLists",
      "description": "Task lists for todo items and checklists.\n- Interactive checkbox display\n- Mixed checked/unchecked states\n- Nested task lists support",
      "source": ""
    },
    {
      "id": "components-mdrender--tables",
      "name": "Tables",
      "exportName": "Tables",
      "description": "Tables with different alignments and formatting.\n- Left, center, and right alignment\n- Complex table structures\n- Tables with formatted content",
      "source": ""
    },
    {
      "id": "components-mdrender--nested-structures",
      "name": "Nested Structures",
      "exportName": "NestedStructures",
      "description": "Nested and complex structures.\n- Nested lists with multiple levels\n- Blockquotes with formatted content\n- Mixed content types",
      "source": ""
    },
    {
      "id": "components-mdrender--with-mentions",
      "name": "With Mentions",
      "exportName": "WithMentions",
      "description": "Basic mention rendering in markdown content.\n- Simple",
      "source": ""
    },
    {
      "id": "components-mdrender--custom-mention-rendering",
      "name": "Custom Mention Rendering",
      "exportName": "CustomMentionRendering",
      "description": "Custom mention component with rich UI.\n- Avatar display in mentions\n- Tooltip with user details\n- Interactive hover states\n- Email link integration",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\n\nexport default function App() {\n\n      const content = `# Project Update\n\n  ## Team Mentions\n\n  I'd like to mention @John Doe and @Jane Smith for their excellent work.\n\n  **Highlights:**\n  - @Bob Johnson completed the authentication feature\n  - @Alice Williams provided great design feedback\n  - @Charlie Brown handled the code review process\n\n  Thanks to @Diana Prince for project management!\n\n  ## Task Assignment\n\n  - [ ] @John Doe - Implement user dashboard\n  - [ ] @Jane Smith - Design new components\n  - [x] @Bob Johnson - Set up CI/CD pipeline\n\n  cc: @Edward Norton @Fiona Apple`\n\n      const mentionItems = [\n        {\n          id: \"1\",\n          label: \"John Doe\",\n          email: \"john@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=1\",\n        },\n        {\n          id: \"2\",\n          label: \"Jane Smith\",\n          email: \"jane@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=2\",\n        },\n        {\n          id: \"3\",\n          label: \"Bob Johnson\",\n          email: \"bob@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=3\",\n        },\n        {\n          id: \"4\",\n          label: \"Alice Williams\",\n          email: \"alice@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=4\",\n        },\n        {\n          id: \"5\",\n          label: \"Charlie Brown\",\n          email: \"charlie@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=5\",\n        },\n        {\n          id: \"6\",\n          label: \"Diana Prince\",\n          email: \"diana@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=6\",\n        },\n        {\n          id: \"7\",\n          label: \"Edward Norton\",\n          email: \"edward@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=7\",\n        },\n        {\n          id: \"8\",\n          label: \"Fiona Apple\",\n          email: \"fiona@example.com\",\n          avatar: \"https://api.dicebear.com/7.x/avataaars/svg?seed=8\",\n        },\n      ]\n\n      const CustomMention = ({ mention }: MentionRenderProps) => {\n        const user = mentionItems.find((item) => item.label === mention)\n        if (!user) {\n          return (\n            <span className=\"bg-secondary-background inline-flex items-center gap-1 rounded-md px-1 align-middle\">\n              @{mention}\n            </span>\n          )\n        }\n\n        return (\n          <Tooltip\n            withArrow={false}\n            className=\"grid grid-cols-[auto_1fr] items-center gap-2 border-none p-2 shadow-lg\"\n            variant=\"light\"\n            content={\n              <>\n                <Avatar\n                  as=\"span\"\n                  photo={user?.avatar}\n                  name={user?.label}\n                  size=\"large\"\n                />\n                <div className=\"flex flex-col\">\n                  <span className=\"text-body-medium-strong\">{user?.label}</span>\n                  <span className=\"text-secondary-foreground\">{user?.email}</span>\n                </div>\n              </>\n            }\n          >\n            <a\n              href={`mailto:${user?.email}`}\n              className=\"bg-secondary-background text-accent-foreground inline-flex cursor-default items-center gap-1 rounded-md px-1 align-middle\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              <Avatar\n                as=\"span\"\n                photo={user?.avatar}\n                name={user?.label}\n                size=\"small\"\n              />\n              {mention}\n            </a>\n          </Tooltip>\n        )\n      }\n\n      return (\n        <MdRender\n          content={content}\n          mentionItems={mentionItems}\n          mentionRenderComponent={CustomMention}\n          allowedPrefixes={[\"https://api.dicebear.com\"]}\n        />\n      )\n\n}"
    },
    {
      "id": "components-mdrender--mentions-in-various-contexts",
      "name": "Mentions In Various Contexts",
      "exportName": "MentionsInVariousContexts",
      "description": "Mentions in various markdown contexts.\n- Mentions in headings, lists, and tables\n- Mentions with formatted text (bold, italic)\n- Mentions in blockquotes and links",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\n\nexport default function App() {\n\n      const content = `# Mention @John Doe in Heading\n\n  ## And @Jane Smith in Subheading\n\n  Paragraph with mention: @Bob Johnson\n\n  **Bold text with @Alice Williams mention**\n\n  *Italic text with @Charlie Brown mention*\n\n  ### Lists with Mentions\n\n  - Item mentioning @John Doe\n  - Another item with @Jane Smith\n  - @Bob Johnson in list item\n\n  ### Blockquote\n\n  > Quote mentioning @Alice Williams\n  > And @Charlie Brown\n\n  ### Task List\n\n  - [x] @John Doe completed setup\n  - [ ] @Jane Smith reviewing code\n  - [ ] @Bob Johnson pending approval\n\n  ### Table\n\n  | Name | Status |\n  |------|--------|\n  | @Jane Smith | Active |\n  | @Bob Johnson | Pending |\n\n  ### Link with Mention\n\n  Check out @John Doe's [profile](https://example.com)`\n\n      const mentionItems = [\n        { id: \"1\", label: \"John Doe\" },\n        { id: \"2\", label: \"Jane Smith\" },\n        { id: \"3\", label: \"Bob Johnson\" },\n        { id: \"4\", label: \"Alice Williams\" },\n        { id: \"5\", label: \"Charlie Brown\" },\n      ]\n\n      const CustomMention = ({ mention }: MentionRenderProps) => {\n        return (\n          <span className=\"bg-accent text-accent-foreground inline-flex items-center rounded px-1.5 py-0.5\">\n            @{mention}\n          </span>\n        )\n      }\n\n      return (\n        <MdRender\n          content={content}\n          mentionItems={mentionItems}\n          mentionRenderComponent={CustomMention}\n        />\n      )\n\n}"
    },
    {
      "id": "components-mdrender--complex-document",
      "name": "Complex Document",
      "exportName": "ComplexDocument",
      "description": "Complex real-world document example.\n- Project README structure\n- Mixed content types\n- Technical documentation format",
      "source": ""
    },
    {
      "id": "components-mdrender--empty-content",
      "name": "Empty Content",
      "exportName": "EmptyContent",
      "description": "Empty content handling.\n- Shows how component behaves with empty string\n- Graceful handling of no content",
      "source": ""
    },
    {
      "id": "components-mdrender--url-whitelist",
      "name": "URL Whitelist",
      "exportName": "UrlWhitelist",
      "description": "",
      "source": ""
    },
    {
      "id": "components-mdrender--url-whitelist-with-mentions",
      "name": "URL Whitelist With Mentions",
      "exportName": "UrlWhitelistWithMentions",
      "description": "",
      "source": ""
    },
    {
      "id": "components-mdrender--long-document",
      "name": "Long Document",
      "exportName": "LongDocument",
      "description": "Long document with extensive content.\n- Tests performance with large content\n- Multiple sections and subsections\n- Various content types mixed together",
      "source": ""
    },
    {
      "id": "components-mdrender--typography-scale",
      "name": "Typography Scale",
      "exportName": "TypographyScale",
      "description": "",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\n\nexport default function App() {\n\n  return (\n    <div className=\"max-w-4xl p-6\">\n      <div className=\"mb-8\">\n        <h2 className=\"text-body-large-strong mb-4\">Normal Mode</h2>\n        <MdRender content={typographyScaleContent} />\n      </div>\n      <hr className=\"my-8\" />\n      <div>\n        <h2 className=\"text-body-large-strong mb-4\">Compact Mode</h2>\n        <MdRender\n          content={typographyScaleContent}\n          size=\"small\"\n        />\n      </div>\n    </div>\n  )\n\n}"
    },
    {
      "id": "components-mdrender--size-comparison",
      "name": "Size Comparison",
      "exportName": "SizeComparison",
      "description": "Size Comparison: Shows all three sizing modes side by side.\n- Small (13px): Compact mode for space-constrained UIs\n- Default (14px): Standard mode for general content\n- Large (16px): Enhanced readability for long-form content\n- Demonstrates proportional scaling of headings and spacing",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\n\nexport default function App() {\n\n  return (\n    <div className=\"flex gap-6 p-6\">\n      <div className=\"w-80 rounded-xl border bg-white p-4 dark:bg-gray-900\">\n        <h3 className=\"text-body-small font-strong mb-4 text-gray-500 uppercase\">Small (13px)</h3>\n        <MdRender\n          content={sizingContent}\n          size=\"small\"\n        />\n      </div>\n      <div className=\"w-80 rounded-xl border bg-white p-4 dark:bg-gray-900\">\n        <h3 className=\"text-body-small font-strong mb-4 text-gray-500 uppercase\">\n          Default (14px)\n        </h3>\n        <MdRender content={sizingContent} />\n      </div>\n      <div className=\"w-80 rounded-xl border bg-white p-4 dark:bg-gray-900\">\n        <h3 className=\"text-body-small font-strong mb-4 text-gray-500 uppercase\">Large (16px)</h3>\n        <MdRender\n          content={sizingContent}\n          size=\"large\"\n        />\n      </div>\n    </div>\n  )\n\n}"
    },
    {
      "id": "components-mdrender--large-mode-documentation",
      "name": "Large Mode Documentation",
      "exportName": "LargeModeDocumentation",
      "description": "Large Mode for Documentation: Shows large mode with extensive documentation content.\n- 16px base font size for enhanced readability\n- Increased spacing between sections\n- Ideal for technical documentation and articles\n- Better visual hierarchy with larger headings",
      "source": ""
    },
    {
      "id": "components-mdrender--github-variant",
      "name": "Github Variant",
      "exportName": "GithubVariant",
      "description": "Github Variant: Shows the github variant of the markdown renderer.",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\n\nexport default function App() {\n\n  return (\n    <div className=\"grid grid-cols-2 gap-6 p-6\">\n      <div className=\"w-full rounded-xl border bg-white p-4 dark:bg-gray-900\">\n        <h3 className=\"text-body-small font-strong mb-4 text-gray-500 uppercase\">Default</h3>\n        <MdRender\n          content={sizingContent}\n          variant=\"default\"\n        />\n      </div>\n\n      <div className=\"w-full rounded-xl border bg-white p-4 dark:bg-gray-900\">\n        <h3 className=\"text-body-small font-strong mb-4 text-gray-500 uppercase\">Github</h3>\n        <MdRender\n          content={sizingContent}\n          variant=\"github\"\n        />\n      </div>\n    </div>\n  )\n\n}"
    },
    {
      "id": "components-mdrender--streaming-markdown",
      "name": "Streaming Markdown",
      "exportName": "StreamingMarkdown",
      "description": "Streaming Markdown: Simulates AI-generated markdown content with auto-scroll.\n- Uses useStickToBottom hook to keep scroll at bottom\n- Content appears chunk by chunk like streaming responses\n- Demonstrates how markdown renders progressively",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\nimport { useState, useRef } from \"react\"\n\nexport default function App() {\n\n  const [content, setContent] = useState(\"\")\n  const [isStreaming, setIsStreaming] = useState(false)\n  const chunkIndexRef = useRef(0)\n\n  const { scrollRef, contentRef, isAtBottom, scrollToBottom } = useStickToBottom({\n    resize: \"smooth\",\n    initial: \"instant\",\n  })\n\n  const addChunk = () => {\n    if (chunkIndexRef.current < streamingMarkdownChunks.length) {\n      setContent((prev) => prev + streamingMarkdownChunks[chunkIndexRef.current])\n      chunkIndexRef.current++\n    }\n  }\n\n  const startStreaming = () => {\n    if (isStreaming) return\n    setIsStreaming(true)\n\n    const interval = setInterval(() => {\n      if (chunkIndexRef.current < streamingMarkdownChunks.length) {\n        addChunk()\n      } else {\n        clearInterval(interval)\n        setIsStreaming(false)\n      }\n    }, 800)\n  }\n\n  const reset = () => {\n    setContent(\"\")\n    chunkIndexRef.current = 0\n    setIsStreaming(false)\n  }\n\n  return (\n    <div className=\"flex h-[600px] w-[700px] flex-col gap-4\">\n      <div className=\"flex items-center gap-2\">\n        <button\n          onClick={addChunk}\n          disabled={isStreaming || chunkIndexRef.current >= streamingMarkdownChunks.length}\n          className=\"rounded bg-blue-500 px-3 py-1.5 text-sm text-white hover:bg-blue-600 disabled:opacity-50\"\n        >\n          Add Chunk\n        </button>\n        <button\n          onClick={startStreaming}\n          disabled={isStreaming || chunkIndexRef.current >= streamingMarkdownChunks.length}\n          className=\"rounded bg-green-500 px-3 py-1.5 text-sm text-white hover:bg-green-600 disabled:opacity-50\"\n        >\n          {isStreaming ? \"Streaming...\" : \"Auto Stream\"}\n        </button>\n        <button\n          onClick={reset}\n          className=\"rounded bg-gray-500 px-3 py-1.5 text-sm text-white hover:bg-gray-600\"\n        >\n          Reset\n        </button>\n        {!isAtBottom && (\n          <button\n            onClick={() => scrollToBottom()}\n            className=\"rounded bg-orange-500 px-3 py-1.5 text-sm text-white hover:bg-orange-600\"\n          >\n            Scroll to Bottom\n          </button>\n        )}\n      </div>\n\n      <div className=\"text-body-small text-fg-subtle\">\n        Chunks: {chunkIndexRef.current}/{streamingMarkdownChunks.length} | At bottom:{\" \"}\n        {isAtBottom ? \"Yes\" : \"No\"}\n      </div>\n\n      <ScrollArea className=\"flex-1 rounded-lg border\">\n        <ScrollArea.Viewport ref={scrollRef}>\n          <ScrollArea.Content\n            ref={contentRef}\n            className=\"w-full min-w-0 p-4\"\n          >\n            {content ? (\n              <MdRender content={content} />\n            ) : (\n              <div className=\"text-body-small text-fg-subtle py-8 text-center\">\n                Click &quot;Add Chunk&quot; or &quot;Auto Stream&quot; to start\n              </div>\n            )}\n          </ScrollArea.Content>\n        </ScrollArea.Viewport>\n      </ScrollArea>\n    </div>\n  )\n\n}"
    },
    {
      "id": "components-mdrender--character-streaming-markdown",
      "name": "Character Streaming Markdown",
      "exportName": "CharacterStreamingMarkdown",
      "description": "Character-by-character streaming markdown simulation.\n- Content appears gradually like typing effect\n- Auto-scroll follows the content\n- Demonstrates real-time markdown parsing",
      "source": "import { MdRender } from \"@choice-ui/md-render\"\nimport { useState, useEffect, useCallback, useMemo, useRef } from \"react\"\n\nexport default function App() {\n\n      const [streamedContent, setStreamedContent] = useState(\"\")\n      const [isStreaming, setIsStreaming] = useState(false)\n\n      const fullContent = `# Welcome to the Design System\n\n  This is a **streaming demonstration** that shows how markdown content can be rendered progressively with multiple long code blocks.\n\n  ## React Hook Example\n\n  Here's a comprehensive custom hook implementation:\n\n  \\`\\`\\`typescript\n  import { useState, useEffect, useCallback, useMemo, useRef } from 'react'\n\n  interface FetchState<T> {\n    data: T | null\n    loading: boolean\n    error: Error | null\n    refetch: () => Promise<void>\n  }\n\n  interface FetchOptions<T> {\n    url: string\n    method?: 'GET' | 'POST' | 'PUT' | 'DELETE'\n    body?: Record<string, unknown>\n    headers?: Record<string, string>\n    transform?: (data: unknown) => T\n    onSuccess?: (data: T) => void\n    onError?: (error: Error) => void\n    enabled?: boolean\n    refetchInterval?: number\n    retryCount?: number\n    retryDelay?: number\n  }\n\n  export function useFetch<T>(options: FetchOptions<T>): FetchState<T> {\n    const {\n      url,\n      method = 'GET',\n      body,\n      headers = {},\n      transform,\n      onSuccess,\n      onError,\n      enabled = true,\n      refetchInterval,\n      retryCount = 3,\n      retryDelay = 1000,\n    } = options\n\n    const [data, setData] = useState<T | null>(null)\n    const [loading, setLoading] = useState(false)\n    const [error, setError] = useState<Error | null>(null)\n    const retryCountRef = useRef(0)\n    const abortControllerRef = useRef<AbortController | null>(null)\n\n    const fetchData = useCallback(async () => {\n      if (!enabled) return\n\n      // Cancel previous request\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort()\n      }\n      abortControllerRef.current = new AbortController()\n\n      setLoading(true)\n      setError(null)\n\n      try {\n        const response = await fetch(url, {\n          method,\n          headers: {\n            'Content-Type': 'application/json',\n            ...headers,\n          },\n          body: body ? JSON.stringify(body) : undefined,\n          signal: abortControllerRef.current.signal,\n        })\n\n        if (!response.ok) {\n          throw new Error(\\`HTTP error! status: \\${response.status}\\`)\n        }\n\n        const rawData = await response.json()\n        const transformedData = transform ? transform(rawData) : rawData as T\n\n        setData(transformedData)\n        onSuccess?.(transformedData)\n        retryCountRef.current = 0\n      } catch (err) {\n        if (err instanceof Error && err.name === 'AbortError') {\n          return // Ignore abort errors\n        }\n\n        const error = err instanceof Error ? err : new Error('Unknown error')\n\n        if (retryCountRef.current < retryCount) {\n          retryCountRef.current++\n          setTimeout(fetchData, retryDelay * retryCountRef.current)\n          return\n        }\n\n        setError(error)\n        onError?.(error)\n      } finally {\n        setLoading(false)\n      }\n    }, [url, method, body, headers, transform, onSuccess, onError, enabled, retryCount, retryDelay])\n\n    useEffect(() => {\n      fetchData()\n\n      return () => {\n        abortControllerRef.current?.abort()\n      }\n    }, [fetchData])\n\n    useEffect(() => {\n      if (!refetchInterval || !enabled) return\n\n      const intervalId = setInterval(fetchData, refetchInterval)\n      return () => clearInterval(intervalId)\n    }, [fetchData, refetchInterval, enabled])\n\n    const memoizedState = useMemo(() => ({\n      data,\n      loading,\n      error,\n      refetch: fetchData,\n    }), [data, loading, error, fetchData])\n\n    return memoizedState\n  }\n  \\`\\`\\`\n\n  ## React Component Example\n\n  A complex form component with validation:\n\n  \\`\\`\\`tsx\n  import React, { useState, useCallback, useEffect, FormEvent } from 'react'\n  import { motion, AnimatePresence } from 'framer-motion'\n\n  interface FormField {\n    name: string\n    type: 'text' | 'email' | 'password' | 'number' | 'textarea'\n    label: string\n    placeholder?: string\n    required?: boolean\n    minLength?: number\n    maxLength?: number\n    pattern?: RegExp\n    errorMessage?: string\n  }\n\n  interface DynamicFormProps {\n    fields: FormField[]\n    onSubmit: (data: Record<string, string>) => Promise<void>\n    submitText?: string\n    className?: string\n  }\n\n  export function DynamicForm({\n    fields,\n    onSubmit,\n    submitText = 'Submit',\n    className,\n  }: DynamicFormProps) {\n    const [formData, setFormData] = useState<Record<string, string>>({})\n    const [errors, setErrors] = useState<Record<string, string>>({})\n    const [touched, setTouched] = useState<Record<string, boolean>>({})\n    const [isSubmitting, setIsSubmitting] = useState(false)\n    const [submitError, setSubmitError] = useState<string | null>(null)\n    const [submitSuccess, setSubmitSuccess] = useState(false)\n\n    // Initialize form data\n    useEffect(() => {\n      const initialData: Record<string, string> = {}\n      fields.forEach(field => {\n        initialData[field.name] = ''\n      })\n      setFormData(initialData)\n    }, [fields])\n\n    const validateField = useCallback((field: FormField, value: string): string | null => {\n      if (field.required && !value.trim()) {\n        return field.errorMessage || \\`\\${field.label} is required\\`\n      }\n\n      if (field.minLength && value.length < field.minLength) {\n        return \\`\\${field.label} must be at least \\${field.minLength} characters\\`\n      }\n\n      if (field.maxLength && value.length > field.maxLength) {\n        return \\`\\${field.label} must be no more than \\${field.maxLength} characters\\`\n      }\n\n      if (field.pattern && !field.pattern.test(value)) {\n        return field.errorMessage || \\`\\${field.label} format is invalid\\`\n      }\n\n      if (field.type === 'email' && value) {\n        const emailRegex = /^[^\\\\s@]+@[^\\\\s@]+\\\\.[^\\\\s@]+$/\n        if (!emailRegex.test(value)) {\n          return 'Please enter a valid email address'\n        }\n      }\n\n      return null\n    }, [])\n\n    const handleChange = useCallback((name: string, value: string) => {\n      setFormData(prev => ({ ...prev, [name]: value }))\n\n      const field = fields.find(f => f.name === name)\n      if (field && touched[name]) {\n        const error = validateField(field, value)\n        setErrors(prev => ({ ...prev, [name]: error || '' }))\n      }\n    }, [fields, touched, validateField])\n\n    const handleBlur = useCallback((name: string) => {\n      setTouched(prev => ({ ...prev, [name]: true }))\n\n      const field = fields.find(f => f.name === name)\n      if (field) {\n        const value = formData[name] || ''\n        const error = validateField(field, value)\n        setErrors(prev => ({ ...prev, [name]: error || '' }))\n      }\n    }, [fields, formData, validateField])\n\n    const handleSubmit = useCallback(async (e: FormEvent) => {\n      e.preventDefault()\n      setSubmitError(null)\n      setSubmitSuccess(false)\n\n      // Validate all fields\n      const newErrors: Record<string, string> = {}\n      let hasErrors = false\n\n      fields.forEach(field => {\n        const error = validateField(field, formData[field.name] || '')\n        if (error) {\n          newErrors[field.name] = error\n          hasErrors = true\n        }\n      })\n\n      setErrors(newErrors)\n      setTouched(Object.fromEntries(fields.map(f => [f.name, true])))\n\n      if (hasErrors) return\n\n      setIsSubmitting(true)\n\n      try {\n        await onSubmit(formData)\n        setSubmitSuccess(true)\n        // Reset form\n        const resetData: Record<string, string> = {}\n        fields.forEach(field => {\n          resetData[field.name] = ''\n        })\n        setFormData(resetData)\n        setTouched({})\n      } catch (err) {\n        setSubmitError(err instanceof Error ? err.message : 'Submission failed')\n      } finally {\n        setIsSubmitting(false)\n      }\n    }, [fields, formData, onSubmit, validateField])\n\n    return (\n      <form onSubmit={handleSubmit} className={className}>\n        <AnimatePresence>\n          {fields.map((field, index) => (\n            <motion.div\n              key={field.name}\n              initial={{ opacity: 0, y: 20 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: index * 0.1 }}\n              className=\"mb-4\"\n            >\n              <label className=\"block text-sm font-medium mb-1\">\n                {field.label}\n                {field.required && <span className=\"text-red-500 ml-1\">*</span>}\n              </label>\n              {field.type === 'textarea' ? (\n                <textarea\n                  name={field.name}\n                  value={formData[field.name] || ''}\n                  onChange={e => handleChange(field.name, e.target.value)}\n                  onBlur={() => handleBlur(field.name)}\n                  placeholder={field.placeholder}\n                  className=\"w-full px-3 py-2 border rounded-md\"\n                  rows={4}\n                />\n              ) : (\n                <input\n                  type={field.type}\n                  name={field.name}\n                  value={formData[field.name] || ''}\n                  onChange={e => handleChange(field.name, e.target.value)}\n                  onBlur={() => handleBlur(field.name)}\n                  placeholder={field.placeholder}\n                  className=\"w-full px-3 py-2 border rounded-md\"\n                />\n              )}\n              {touched[field.name] && errors[field.name] && (\n                <motion.p\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  className=\"text-red-500 text-sm mt-1\"\n                >\n                  {errors[field.name]}\n                </motion.p>\n              )}\n            </motion.div>\n          ))}\n        </AnimatePresence>\n\n        {submitError && (\n          <div className=\"text-red-500 mb-4\">{submitError}</div>\n        )}\n\n        {submitSuccess && (\n          <div className=\"text-green-500 mb-4\">Form submitted successfully!</div>\n        )}\n\n        <button\n          type=\"submit\"\n          disabled={isSubmitting}\n          className=\"w-full py-2 px-4 bg-blue-500 text-white rounded-md\"\n        >\n          {isSubmitting ? 'Submitting...' : submitText}\n        </button>\n      </form>\n    )\n  }\n  \\`\\`\\`\n\n  ## Python Backend Example\n\n  A FastAPI server implementation:\n\n  \\`\\`\\`python\n  from fastapi import FastAPI, HTTPException, Depends, BackgroundTasks\n  from fastapi.middleware.cors import CORSMiddleware\n  from pydantic import BaseModel, Field, validator\n  from typing import Optional, List, Dict, Any\n  from datetime import datetime, timedelta\n  from sqlalchemy.orm import Session\n  from sqlalchemy import create_engine, Column, Integer, String, DateTime, Boolean\n  from sqlalchemy.ext.declarative import declarative_base\n  from sqlalchemy.orm import sessionmaker\n  import asyncio\n  import logging\n  import uuid\n\n  # Database setup\n  DATABASE_URL = \"postgresql://user:password@localhost/dbname\"\n  engine = create_engine(DATABASE_URL)\n  SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)\n  Base = declarative_base()\n\n  # Configure logging\n  logging.basicConfig(level=logging.INFO)\n  logger = logging.getLogger(__name__)\n\n  # Models\n  class UserModel(Base):\n      __tablename__ = \"users\"\n\n      id = Column(String, primary_key=True, default=lambda: str(uuid.uuid4()))\n      email = Column(String, unique=True, index=True, nullable=False)\n      username = Column(String, unique=True, index=True, nullable=False)\n      hashed_password = Column(String, nullable=False)\n      is_active = Column(Boolean, default=True)\n      is_verified = Column(Boolean, default=False)\n      created_at = Column(DateTime, default=datetime.utcnow)\n      updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)\n\n  # Pydantic schemas\n  class UserCreate(BaseModel):\n      email: str\n      username: str\n      password: str\n\n      @validator('email')\n      def validate_email(cls, v):\n          if '@' not in v:\n              raise ValueError('Invalid email format')\n          return v.lower()\n\n      @validator('password')\n      def validate_password(cls, v):\n          if len(v) < 8:\n              raise ValueError('Password must be at least 8 characters')\n          return v\n\n  class UserResponse(BaseModel):\n      id: str\n      email: str\n      username: str\n      is_active: bool\n      is_verified: bool\n      created_at: datetime\n\n      class Config:\n          from_attributes = True\n\n  class UserUpdate(BaseModel):\n      email: Optional[str] = None\n      username: Optional[str] = None\n\n  # App setup\n  app = FastAPI(\n      title=\"User Management API\",\n      description=\"A comprehensive user management system\",\n      version=\"1.0.0\",\n  )\n\n  app.add_middleware(\n      CORSMiddleware,\n      allow_origins=[\"*\"],\n      allow_credentials=True,\n      allow_methods=[\"*\"],\n      allow_headers=[\"*\"],\n  )\n\n  # Dependencies\n  def get_db():\n      db = SessionLocal()\n      try:\n          yield db\n      finally:\n          db.close()\n\n  # Background tasks\n  async def send_verification_email(email: str, token: str):\n      logger.info(f\"Sending verification email to {email}\")\n      await asyncio.sleep(2)  # Simulate email sending\n      logger.info(f\"Verification email sent to {email}\")\n\n  async def log_user_activity(user_id: str, action: str):\n      logger.info(f\"User {user_id} performed action: {action}\")\n\n  # Routes\n  @app.post(\"/users/\", response_model=UserResponse, status_code=201)\n  async def create_user(\n      user: UserCreate,\n      background_tasks: BackgroundTasks,\n      db: Session = Depends(get_db)\n  ):\n      # Check if user exists\n      existing_user = db.query(UserModel).filter(\n          (UserModel.email == user.email) | (UserModel.username == user.username)\n      ).first()\n\n      if existing_user:\n          raise HTTPException(status_code=400, detail=\"User already exists\")\n\n      # Create user\n      db_user = UserModel(\n          email=user.email,\n          username=user.username,\n          hashed_password=hash_password(user.password),\n      )\n      db.add(db_user)\n      db.commit()\n      db.refresh(db_user)\n\n      # Send verification email in background\n      verification_token = generate_token()\n      background_tasks.add_task(send_verification_email, user.email, verification_token)\n      background_tasks.add_task(log_user_activity, db_user.id, \"account_created\")\n\n      return db_user\n\n  @app.get(\"/users/\", response_model=List[UserResponse])\n  async def list_users(\n      skip: int = 0,\n      limit: int = 100,\n      is_active: Optional[bool] = None,\n      db: Session = Depends(get_db)\n  ):\n      query = db.query(UserModel)\n\n      if is_active is not None:\n          query = query.filter(UserModel.is_active == is_active)\n\n      users = query.offset(skip).limit(limit).all()\n      return users\n\n  @app.get(\"/users/{user_id}\", response_model=UserResponse)\n  async def get_user(user_id: str, db: Session = Depends(get_db)):\n      user = db.query(UserModel).filter(UserModel.id == user_id).first()\n\n      if not user:\n          raise HTTPException(status_code=404, detail=\"User not found\")\n\n      return user\n\n  @app.put(\"/users/{user_id}\", response_model=UserResponse)\n  async def update_user(\n      user_id: str,\n      user_update: UserUpdate,\n      background_tasks: BackgroundTasks,\n      db: Session = Depends(get_db)\n  ):\n      user = db.query(UserModel).filter(UserModel.id == user_id).first()\n\n      if not user:\n          raise HTTPException(status_code=404, detail=\"User not found\")\n\n      update_data = user_update.dict(exclude_unset=True)\n      for field, value in update_data.items():\n          setattr(user, field, value)\n\n      db.commit()\n      db.refresh(user)\n\n      background_tasks.add_task(log_user_activity, user_id, \"profile_updated\")\n\n      return user\n\n  @app.delete(\"/users/{user_id}\", status_code=204)\n  async def delete_user(\n      user_id: str,\n      background_tasks: BackgroundTasks,\n      db: Session = Depends(get_db)\n  ):\n      user = db.query(UserModel).filter(UserModel.id == user_id).first()\n\n      if not user:\n          raise HTTPException(status_code=404, detail=\"User not found\")\n\n      db.delete(user)\n      db.commit()\n\n      background_tasks.add_task(log_user_activity, user_id, \"account_deleted\")\n\n  def hash_password(password: str) -> str:\n      import hashlib\n      return hashlib.sha256(password.encode()).hexdigest()\n\n  def generate_token() -> str:\n      return str(uuid.uuid4())\n\n  if __name__ == \"__main__\":\n      import uvicorn\n      uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n  \\`\\`\\`\n\n  ## Summary\n\n  > This demonstrates how the MdRender component handles streaming content with multiple long code blocks.\n\n  | Feature | Status |\n  |---------|--------|\n  | Streaming | ✅ |\n  | Auto-scroll | ✅ |\n  | Multiple code blocks | ✅ |\n  | Syntax highlighting | ✅ |\n  | Long content | ✅ |\n\n  **Testing complete!**`\n\n      const { scrollRef, contentRef } = useStickToBottom({\n        resize: \"smooth\",\n        initial: \"instant\",\n      })\n\n      const startCharacterStream = () => {\n        if (isStreaming) return\n        setIsStreaming(true)\n        setStreamedContent(\"\")\n\n        let index = 0\n        const interval = setInterval(() => {\n          if (index < fullContent.length) {\n            const chunkSize = Math.floor(Math.random() * 8) + 2\n            setStreamedContent(fullContent.slice(0, index + chunkSize))\n            index += chunkSize\n          } else {\n            clearInterval(interval)\n            setIsStreaming(false)\n          }\n        }, 15)\n      }\n\n      const reset = () => {\n        setStreamedContent(\"\")\n        setIsStreaming(false)\n      }\n\n      return (\n        <div className=\"flex h-[500px] w-[600px] flex-col gap-4\">\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={startCharacterStream}\n              disabled={isStreaming}\n              className=\"rounded bg-blue-500 px-3 py-1.5 text-sm text-white hover:bg-blue-600 disabled:opacity-50\"\n            >\n              {isStreaming ? \"Streaming...\" : \"Start Stream\"}\n            </button>\n            <button\n              onClick={reset}\n              className=\"rounded bg-gray-500 px-3 py-1.5 text-sm text-white hover:bg-gray-600\"\n            >\n              Reset\n            </button>\n          </div>\n\n          <ScrollArea className=\"flex-1 rounded-lg border\">\n            <ScrollArea.Viewport ref={scrollRef}>\n              <ScrollArea.Content\n                ref={contentRef}\n                className=\"w-full min-w-0 p-4\"\n              >\n                {streamedContent ? (\n                  <MdRender content={streamedContent} />\n                ) : (\n                  <div className=\"text-body-small text-fg-subtle py-8 text-center\">\n                    Click &quot;Start Stream&quot; to begin character-by-character streaming\n                  </div>\n                )}\n              </ScrollArea.Content>\n            </ScrollArea.Viewport>\n          </ScrollArea>\n        </div>\n      )\n\n}"
    }
  ]
}